'use client'

import { useMutation, useQuery } from '@tanstack/react-query'
import '../../scss/components/recordsForm.scss'
import { useForm } from 'react-hook-form'
import axios from 'axios'
import Logo from '../../../public/Logo.png'
import { useEffect, useState } from 'react'
import Image from 'next/image'
import Popup from './popup'

export default function RecordsIn() {
	const { register, reset, handleSubmit, setValue } = useForm()
	const [checkboxValue, setcheckboxValue] = useState(true)
	const [token, setToken] = useState('')
	const [showPopup, setShowPopup] = useState(false)
	const [options, setOptions] = useState([])
	const [selected, setSelected] = useState(false)
	const nameCount = {}

	const query = useQuery({
		queryKey: ['searchIn'],
		queryFn: async () => {
			const response = await axios.get(`http://10.1.1.19:3001/records/stock?code=0`)
			return response.data
		},
	})

	const mutation = useMutation({
		mutationFn: async (data) => {
			const { name, description, quantity, product_code, product_id, checkbox } = data
			const response = await axios.post(
				'http://10.1.1.19:3001/records/in',
				{
					name,
					description,
					quantity: checkbox ? 1 : parseInt(quantity),
					product_code: parseInt(product_code) || 0,
					product_id: parseInt(product_id) || null,
				},
				{
					headers: {
						Authorization: `${token}`,
					},
				}
			)
			return response.data
		},
		onSuccess: () => {
			setShowPopup({ message: 'Sucesso! Novo registro salvo.', color: 'green' })
			setTimeout(() => {
				setShowPopup(false)
			}, 4000)
			query.refetch()
		},
	})

	useEffect(() => {
		if (mutation.data != undefined) {
			if (mutation.data == 'Created') reset()
			if (mutation.data.message) {
				setShowPopup({ message: 'Patrimônio já em estoque', color: 'red' })
				setTimeout(() => {
					setShowPopup(false)
				}, 4000)
			}
		}
	}, [mutation.data])

	useEffect(() => {
		const tokenStorage = localStorage.getItem('uat_cs1')
		if (!tokenStorage) return
		const { token } = JSON.parse(tokenStorage)
		setToken(token)
	}, [])

	useEffect(() => {
		if (query.data != [] && query.data != {} && query.data != undefined) {
			setOptions(query.data)
		}
	}, [query.data])

	function onSubmit(data) {
		mutation.mutate(data)
	}

	function handleChange(event) {
		setcheckboxValue(event.target.checked)
	}

	function handleClick(data) {
		setSelected(true)
		setValue('product_code', '-')
		setValue('description', data.description)
		setValue('name', data.name)
		setValue('product_id', data.id)
	}

	function handleInput() {
		if (selected) reset()
	}

	useEffect(() => {
		const tokenStorage = localStorage.getItem('uat_cs1')
		if (!tokenStorage) return
		const { token } = JSON.parse(tokenStorage)
		setToken(token)
		// const csv =
		// 	'Monitor, SAMSUNG SyncMaster, 26414;Monitor, AOC E950SW, 35518;Monitor, SAMSUNG S19B300, 34171;Monitor, AOC E950SW, 35525;Monitor, DELL E1709WC, 30622;Monitor, DELL E1709WC, 30563;Monitor, DELL E1709WC, 30177;Monitor, DELL E1709WC, 30175;Monitor, DELL E1709WC, 30625;Monitor, DELL E1709WC, 30633;Monitor, DELL E1709WC, 30178;Monitor, DELL E1709WC, 30560;Monitor, DELL E1709WC, 30615;Monitor, DELL E1709WC, 30617;Monitor, DELL E1709WC, 30557;Monitor, DELL E1709WC, 30566;Monitor, DELL E1709WC, 30562;Monitor, DELL E1709WC, 30616;Monitor, DELL E1709WC, 30176;Monitor, DELL E1709WC, 30166;Monitor, DELL E1709WC, 30153;Monitor, DELL E1709WC, 30623;Monitor, POSITIVO E1941SX, 35806;Monitor, LG W1942ST, 27847;Monitor, POSITIVO P971WAL-P, 36157;Monitor, POSITIVO P971WAL-P, 34467;Monitor, POSITIVO P971WAL-P, 34470;Monitor, SAMSUNG 932BWE, 27536;Monitor, POSITIVO P971WAL-P, 36168;Monitor, DELL E1910C, 32236;Monitor, AOC E950SW, 35513;Monitor, POSITIVO E1941SX, 35827;Monitor, DELL E1912HC, 34159;Monitor, DELL E1910C, 32201;Monitor, POSITIVO P971WAL-P, 36158;Monitor, POSITIVO E1941SX, 35832;Monitor, DELL E1912HC, 34147;Monitor, LENOVO D1960WA, 30059;Monitor, HP V194BZ, 44507;Monitor, DELL E1709WC, 30554;Monitor, LENOVO D1960WA, 34023;Monitor, POSITIVO P971WAL-P, 34321;Monitor, DELL E1709WC, 30171;Monitor, DELL E1709WC, 30180;Monitor, BENQ GL930-B, 34073;Monitor, SAMSUNG 633NW, 31089;Monitor, POSITIVO E1941SX, 35811;Monitor, POSITIVO E1941SX, 35833;Monitor, POSITIVO P971WAL-P, 36141;Monitor, SAMSUNG S19C301F, 42506;Monitor, POSITIVO P971WAL-P, 34755;Monitor, POSITIVO P971WAL-P, 34485;Monitor, POSITIVO P971WAL-P, 34312;Monitor, POSITIVO P971WAL-P, 34757;Monitor, POSITIVO P971WAL-P, 34364;Monitor, POSITIVO P971WAL-P, 34410;Monitor, LENOVO D1960WA, 32578;Monitor, POSITIVO P971WAL-P, 34409;Monitor, POSITIVO P971WAL-P, 34462;Monitor, POSITIVO E1941SX, 35841;Monitor, POSITIVO P971WAL-P, 34762;Monitor, POSITIVO P971WAL-P, 34368;Monitor, POSITIVO E1941SX, 35835;Monitor, POSITIVO E1941SX, 35807;Monitor, DELL E1910C, 32294;Monitor, POSITIVO E1941SX, 35804;Monitor, POSITIVO E1941SX, 35820;Monitor, POSITIVO E1941SX, 35826;Monitor, SAMSUNG S19C301F, 42551;Monitor, SAMSUNG S19C301F, 42555;Monitor, SAMSUNG S19C301F, 42558;Monitor, AOC E950SW, 35514;Monitor, POSITIVO E1941SX, 35825;Monitor, DELL E1912HC, 34154;Monitor, AOC E950SW, 35520;Monitor, SAMSUNG S19B300, 34172;Monitor, POSITIVO E1941SX, 35815;Monitor, DELL E1910C, 32285;Monitor, DELL E1910C, 32213;Monitor, DELL E1910C, 32256;Monitor, POSITIVO P971WAL-P, 34256;Monitor, POSITIVO P971WAL-P, 34734;Monitor, POSITIVO P971WAL-P, 34766;Monitor, POSITIVO P971WAL-P, 34249;Monitor, DELL E1916HF, 48986;Monitor, DELL E1916HF, 48987;Monitor, DELL P2018H, 2131;Monitor, LG 20EN33SSA, 44548;Monitor, LG 20EN33SSA, 43267;Monitor, DELL E2222HSF, 71726;Monitor, DELL E2222HSF, 51439;Monitor, DELL E2222HSF, 71727;Monitor, AOC E950SW, 35516;Monitor, SAMSUNG 633NW, 31083;Monitor, DELL E1709WC, 30147;Monitor, DELL E1916HF, 48378;Monitor, DELL E1910C, 32293;Monitor, DELL E1709WC, 30641;Monitor, LG FLATRON, 36026;Monitor, DELL E1916HF, 47012;Monitor, DELL E1910C, 32281;Monitor, POSITIVO E1941DC, 30610868;Monitor, SAMSUNG S19C301F, 42550;Monitor, POSITIVO E1941SX, 35843;Monitor, POSITIVO E1941SX, 35812;Monitor, POSITIVO E1941SX, 35839;Monitor, DELL E1916HF, 49855;Monitor, DELL E1916HF, 48391;Monitor, DELL E1916HF, 49861;Monitor, DELL E1916HF, 49856;Monitor, DELL E1916HF, 44764;Monitor, DELL E1916HF, 49968;Monitor, DELL E1916HF, 49857;Monitor, DELL E1916HF, 44762;Monitor, DELL E1916HF, 59P-09NI;Monitor, DELL E1916HF, 59P-10AI;Monitor, DELL E1916HF, 46790;Monitor, DELL E1916HF, 48953;Monitor, DELL E1916HF, 49871;Monitor, DELL E1916HF, 46906;Monitor, DELL E1916HF, 48728;Monitor, DELL E1916HF, 49858;Monitor, DELL E1916HF, 49959;Monitor, DELL E1916HF, 49962;Monitor, DELL E1916HF, 44429;Monitor, DELL E1916HF, 50001;Monitor, DELL E1916HF, 48958;Monitor, DELL E1916HF, 46978;Monitor, DELL E1916HF, 46914;Monitor, DELL E1916HF, 49859;Monitor, DELL E1916HF, 49955;Monitor, DELL E1916HF, 49951;Monitor, DELL E1916HF, 47099;Monitor, DELL E1916HF, 44398;Monitor, DELL E1916HF, 44418;Monitor, LG 20EN33, 36023;Monitor, SAMSUNG S19C301F, 42553;Monitor, POSITIVO P971WAL - P, 34217;Monitor, AOC e950Sw, 35524;Monitor, LG 20EN33, 311SPEDOT244;Monitor, PHILLIPS 196V4L, FX5A131;Monitor, LG 20EN33, 36031;Monitor, LG E1941S, 30403;Monitor, AOC E905sW, 35517;Monitor, DELL E1916HF, 46799;Monitor, DELL E1912HC, 34155;Monitor, POSITIVO P971WAL - P, 34244;Monitor, POSITIVO E1941SX, 35836;COMPUTADOR, MONTADA N/A, 36074;COMPUTADOR, POSITIVO D550, 34455;COMPUTADOR, DELL 390, 30673;COMPUTADOR, POSITIVO D550, 34837;COMPUTADOR, POSITIVO D550, 34845;COMPUTADOR, MONTADA multilaser, 71971;COMPUTADOR, DELL 3040, 46933;COMPUTADOR, C3PLUS MONTADA, 38600;COMPUTADOR, DELL 3050, 48015;COMPUTADOR, DELL 3050, 48026;COMPUTADOR, DELL 3050, 48344;COMPUTADOR, DELL 3060, 49946;COMPUTADOR, DELL 3040, 46740;COMPUTADOR, DELL 3040, 46834;COMPUTADOR, DELL 3040, 46880;COMPUTADOR, DELL 3040, 46772;COMPUTADOR, DELL 3040, 46850;COMPUTADOR, DELL 3040, 46839;COMPUTADOR, DELL 3040, 46776;COMPUTADOR, DELL 3040, 46859;COMPUTADOR, DELL 3040, 47038;COMPUTADOR, DELL 3040, 47059;COMPUTADOR, DELL 3040, 46934;COMPUTADOR, DELL 3040, 47040;COMPUTADOR, DELL 3040, 46775;COMPUTADOR, DELL 3040, 46784;COMPUTADOR, DELL 3050, 48023;COMPUTADOR, DELL 3050, 48707;COMPUTADOR, DELL 3050, 48706;COMPUTADOR, DELL 3050, 48722;COMPUTADOR, DELL 3050, 48325;COMPUTADOR, DELL 3050, 48306;COMPUTADOR, DELL 3040, 46777;COMPUTADOR, DELL 3040, 46950;COMPUTADOR, DELL 3060, 49987;COMPUTADOR, DELL 3040, 46970;COMPUTADOR, DELL 3020, 44750;COMPUTADOR, DELL 3020, 44780;COMPUTADOR, DELL 3040, 46971;COMPUTADOR, DELL 3040, 46959;REDE, SWITCH 3COM 3C16471, 126628;REDE, FIREWALL SONICWALL TZ215, 42440;REDE, SWITCH ARUBA 1930 24G, 71347;REDE, SWITCH ARUBA 1930 24G, 71348;REDE, SWITCH ARUBA 1930 24G, 71349;REDE, SWITCH ARUBA 1930 24G, 71346;REDE, SWITCH HP 1920S 24P, 37570;REDE, SWITCH HP V1910-48, 42099;REDE, SERVIDOR LENOVO SERV- ST550, ;REDE, AP UNIFI UAP-AC-HD, 51802;REDE, AP UNIFI UAP-AC-HD, 51801;REDE, AP CISCO WAP4410N, 31210;REDE, AP CISCO WAP4410N, 31223;REDE, AP CISCO WAP4410N, 31217;REDE, AP CISCO WAP4410N, 31201;REDE, ROTEADOR MICROTIK CCR1036, 47799;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51774;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51775;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51776;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51777;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51778;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51779;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51780;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51781;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51782;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51783;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51784;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51786;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51787;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51788;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51790;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51791;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51792;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51793;REDE, SWITCH HP JE0094, 42098;REDE, SWITCH HP 1920, 36945;REDE, SWITCH ARUBA 1930 48G, 72019;REDE, SWITCH ARUBA 1930 48G, 72017;REDE, SWITCH ARUBA 1930 24G, 72020;REDE, SWITCH ARUBA 1930 24G, 72021;REDE, SWITCH UNIFI USW-24-POE, 51762;REDE, AP UNIFI UAP-AC-HD, 51817;REDE, AP UNIFI UAP-AC-HD, 51818;REDE, AP UNIFI UAP-AC-HD, 51825;REDE, AP UNIFI UAP-AC-HD, 51819;REDE, AP UNIFI UAP-AC-HD, 51823;REDE, AP UNIFI UAP-AC-HD, 51821;REDE, AP UNIFI UAP-AC-HD, 51822;REDE, AP UNIFI UAP-AC-HD, 51820;REDE, AP UNIFI UAP-AC-HD, 51826;REDE, AP UNIFI UAP-AC-HD, 51824;REDE, SWITCH CISCO CATALYST 1000, 72063;REDE, SWITCH CISCO CATALYST 1000, 72064;REDE, ROTEADOR CISCO ISR 4221, 72061;REDE, ROTEADOR CISCO ISR 4221, 72062;REDE, SWITCH HP 1920S 24P, 38412;REDE, CONVERSOR DE MIDIA PLANET GT-802 (V3), 30904;DIVERSOS, WEBCAM LOGITECH C930E, 51221;DIVERSOS, WEBCAM LOGITECH C930E, 51243;DIVERSOS, WEBCAM LOGITECH C930E, 38793;DIVERSOS, WEBCAM LOGITECH C930E, 51223;DIVERSOS, WEBCAM LOGITECH C930E, 51241;DIVERSOS, WEBCAM LOGITECH C930E, 51217;DIVERSOS, WEBCAM LOGITECH C930E, 51238;DIVERSOS, WEBCAM LOGITECH C930E, 51227;DIVERSOS, CELULAR LG K51S, 38557;DIVERSOS, CELULAR LG K51S, 38559;DIVERSOS, CELULAR LG K51S, 38560;DIVERSOS, CELULAR LG K51S, 38561;DIVERSOS, PROJETOR BENQ DLP , 34539;DIVERSOS, PROJETOR EPSON H719A, 37194;DIVERSOS, MICROFONE BOYA BY-MC2, 38826;DIVERSOS, MICROFONE BOYA BY-MC2, 38832;DIVERSOS, MICROFONE BOYA BY-MC2, 38821;DIVERSOS, MICROFONE BOYA BY-MC2, 38823;DIVERSOS, MICROFONE BOYA BY-MC2, 38827;DIVERSOS, MICROFONE BOYA BY-MC2, 38822;DIVERSOS, MICROFONE BOYA BY-MC2, 38834;DIVERSOS, MICROFONE BOYA BY-MC2, 38835;DIVERSOS, MICROFONE BOYA BY-MC2, 38820;DIVERSOS, MICROFONE BOYA BY-MC2, 38831;DIVERSOS, MICROFONE BOYA BY-MC2, 38830;DIVERSOS, MICROFONE BOYA BY-MC2, 38828;DIVERSOS, MICROFONE BOYA BY-MC2, 38829;DIVERSOS, MICROFONE BOYA BY-MC2, 38833;DIVERSOS, MICROFONE BOYA BY-MC2, 38825;DIVERSOS, MICROFONE BOYA BY-MC2, 38824;DIVERSOS, MICROFONE BOYA BY-MC2, 38838;DIVERSOS, MICROFONE BOYA BY-MC2, 38837;DIVERSOS, MICROFONE BOYA BY-MC2, 38836;DIVERSOS, AMPLIFICADOR TSI TSI-625, 38782;DIVERSOS, AMPLIFICADOR TSI TSI-625, 38783;DIVERSOS, AMPLIFICADOR TSI TSI-625, 38784;DIVERSOS, AMPLIFICADOR NCA SA100ST, 50734;DIVERSOS, AMPLIFICADOR NCA SA100ST, 50733;DIVERSOS, CAIXA DE SOM JBL C621B, 38799;DIVERSOS, CAIXA DE SOM JBL C621B, 38798;DIVERSOS, CAIXA DE SOM JBL C621B, 38803;DIVERSOS, CAIXA DE SOM JBL C621B, 38802;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71527;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71557;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71584;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71562;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71539;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71594;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71552;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71580;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71564;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71549;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71567;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71516;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71596;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71535;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71588;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71578;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71538;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71505;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71548;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71565;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71513;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71501;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71556;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71515;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71577;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71507;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71570;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71536;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71550;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71547;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71600;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71576;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71586;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71544;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71525;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71504;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71571;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71533;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71511;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71569;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71545;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71541;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71572;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71508;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71593;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71574;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71561;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71581;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71524;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71585;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71534;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71587;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71595;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71554;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71568;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71558;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP, 30735;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP, 41941;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP3000, 37624;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP3000, 37623;DIVERSOS, WEBCAM MICROSOFT N/A, 37285;DIVERSOS, RELOGIO DE PONTO DIMEP G05527939F, 72100;DIVERSOS, RELOGIO DE PONTO DIMEP G05527939F, 72098;DIVERSOS, WEBCAM LOGITECH C930E, 51225;DIVERSOS, NOBREAK SMS PRO 1500Bi, 73020;DIVERSOS, NOBREAK SMS PRO 1500Bi, 73019;DIVERSOS, NOBREAK SMS PRO 1500Bi, 73021;NOTEBOOK, DELL P66F, 47428;NOTEBOOK, DELL P66F, 47675;NOTEBOOK, DELL BLACK , 36413;NOTEBOOK, DELL P66F, 47677;NOTEBOOK, DELL P66F, 47434;NOTEBOOK, DELL BLACK , 36417;NOTEBOOK, DELL E6410, 32046;NOTEBOOK, DELL XPS15Z, 34186;NOTEBOOK, DELL XPS15Z, 34185;NOTEBOOK, DELL P39F, 47130;NOTEBOOK, DELL P39F, 43266;NOTEBOOK, LENOVO 81B1, 2012;NOTEBOOK, DELL P66F, 47431;NOTEBOOK, DELL P37G003, 41895;NOTEBOOK, DELL LATITUDE 3400, 2086;NOTEBOOK, DELL P66F, 47672;NOTEBOOK, DELL P66F, 47437;NOTEBOOK, DELL 556 INSPIRON, 47829;NOTEBOOK, DELL LATITUDE 3490, 250;NOTEBOOK, DELL P66F, 47436;NOTEBOOK, DELL P66F, 47426'
		// const csv =
		// 	'COMPUTADOR, MONTADA N/A, 36074;COMPUTADOR, POSITIVO D550, 34455;COMPUTADOR, DELL 390, 30673;COMPUTADOR, POSITIVO D550, 34837;COMPUTADOR, POSITIVO D550, 34845;COMPUTADOR, MONTADA multilaser, 71971;COMPUTADOR, DELL 3040, 46933;COMPUTADOR, C3PLUS MONTADA, 38600;COMPUTADOR, DELL 3050, 48015;COMPUTADOR, DELL 3050, 48026;COMPUTADOR, DELL 3050, 48344;COMPUTADOR, DELL 3060, 49946;COMPUTADOR, DELL 3040, 46740;COMPUTADOR, DELL 3040, 46834;COMPUTADOR, DELL 3040, 46880;COMPUTADOR, DELL 3040, 46772;COMPUTADOR, DELL 3040, 46850;COMPUTADOR, DELL 3040, 46839;COMPUTADOR, DELL 3040, 46776;COMPUTADOR, DELL 3040, 46859;COMPUTADOR, DELL 3040, 47038;COMPUTADOR, DELL 3040, 47059;COMPUTADOR, DELL 3040, 46934;COMPUTADOR, DELL 3040, 47040;COMPUTADOR, DELL 3040, 46775;COMPUTADOR, DELL 3040, 46784;COMPUTADOR, DELL 3050, 48023;COMPUTADOR, DELL 3050, 48707;COMPUTADOR, DELL 3050, 48706;COMPUTADOR, DELL 3050, 48722;COMPUTADOR, DELL 3050, 48325;COMPUTADOR, DELL 3050, 48306;COMPUTADOR, DELL 3040, 46777;COMPUTADOR, DELL 3040, 46950;COMPUTADOR, DELL 3060, 49987;COMPUTADOR, DELL 3040, 46970;COMPUTADOR, DELL 3020, 44750;COMPUTADOR, DELL 3020, 44780;COMPUTADOR, DELL 3040, 46971;COMPUTADOR, DELL 3040, 46959'
		// const csv =
		// 'REDE, SWITCH 3COM 3C16471, 126628;REDE, FIREWALL SONICWALL TZ215, 42440;REDE, SWITCH ARUBA 1930 24G, 71347;REDE, SWITCH ARUBA 1930 24G, 71348;REDE, SWITCH ARUBA 1930 24G, 71349;REDE, SWITCH ARUBA 1930 24G, 71346;REDE, SWITCH HP 1920S 24P, 37570;REDE, SWITCH HP V1910-48, 42099;REDE, SERVIDOR LENOVO SERV- ST550, ;REDE, AP UNIFI UAP-AC-HD, 51802;REDE, AP UNIFI UAP-AC-HD, 51801;REDE, AP CISCO WAP4410N, 31210;REDE, AP CISCO WAP4410N, 31223;REDE, AP CISCO WAP4410N, 31217;REDE, AP CISCO WAP4410N, 31201;REDE, ROTEADOR MICROTIK CCR1036, 47799;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51774;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51775;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51776;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51777;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51778;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51779;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51780;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51781;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51782;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51783;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51784;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51786;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51787;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51788;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51790;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51791;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51792;REDE, CONVERSOR DE MIDIA PLANET GT-802S (V6), 51793;REDE, SWITCH HP JE0094, 42098;REDE, SWITCH HP 1920, 36945;REDE, SWITCH ARUBA 1930 48G, 72019;REDE, SWITCH ARUBA 1930 48G, 72017;REDE, SWITCH ARUBA 1930 24G, 72020;REDE, SWITCH ARUBA 1930 24G, 72021;REDE, SWITCH UNIFI USW-24-POE, 51762;REDE, AP UNIFI UAP-AC-HD, 51817;REDE, AP UNIFI UAP-AC-HD, 51818;REDE, AP UNIFI UAP-AC-HD, 51825;REDE, AP UNIFI UAP-AC-HD, 51819;REDE, AP UNIFI UAP-AC-HD, 51823;REDE, AP UNIFI UAP-AC-HD, 51821;REDE, AP UNIFI UAP-AC-HD, 51822;REDE, AP UNIFI UAP-AC-HD, 51820;REDE, AP UNIFI UAP-AC-HD, 51826;REDE, AP UNIFI UAP-AC-HD, 51824;REDE, SWITCH CISCO CATALYST 1000, 72063;REDE, SWITCH CISCO CATALYST 1000, 72064;REDE, ROTEADOR CISCO ISR 4221, 72061;REDE, ROTEADOR CISCO ISR 4221, 72062;REDE, SWITCH HP 1920S 24P, 38412;REDE, CONVERSOR DE MIDIA PLANET GT-802 (V3), 30904'
		// const csv =
		// 'DIVERSOS, WEBCAM LOGITECH C930E, 51221;DIVERSOS, WEBCAM LOGITECH C930E, 51243;DIVERSOS, WEBCAM LOGITECH C930E, 38793;DIVERSOS, WEBCAM LOGITECH C930E, 51223;DIVERSOS, WEBCAM LOGITECH C930E, 51241;DIVERSOS, WEBCAM LOGITECH C930E, 51217;DIVERSOS, WEBCAM LOGITECH C930E, 51238;DIVERSOS, WEBCAM LOGITECH C930E, 51227;DIVERSOS, CELULAR LG K51S, 38557;DIVERSOS, CELULAR LG K51S, 38559;DIVERSOS, CELULAR LG K51S, 38560;DIVERSOS, CELULAR LG K51S, 38561;DIVERSOS, PROJETOR BENQ DLP , 34539;DIVERSOS, PROJETOR EPSON H719A, 37194;DIVERSOS, MICROFONE BOYA BY-MC2, 38826;DIVERSOS, MICROFONE BOYA BY-MC2, 38832;DIVERSOS, MICROFONE BOYA BY-MC2, 38821;DIVERSOS, MICROFONE BOYA BY-MC2, 38823;DIVERSOS, MICROFONE BOYA BY-MC2, 38827;DIVERSOS, MICROFONE BOYA BY-MC2, 38822;DIVERSOS, MICROFONE BOYA BY-MC2, 38834;DIVERSOS, MICROFONE BOYA BY-MC2, 38835;DIVERSOS, MICROFONE BOYA BY-MC2, 38820;DIVERSOS, MICROFONE BOYA BY-MC2, 38831;DIVERSOS, MICROFONE BOYA BY-MC2, 38830;DIVERSOS, MICROFONE BOYA BY-MC2, 38828;DIVERSOS, MICROFONE BOYA BY-MC2, 38829;DIVERSOS, MICROFONE BOYA BY-MC2, 38833;DIVERSOS, MICROFONE BOYA BY-MC2, 38825;DIVERSOS, MICROFONE BOYA BY-MC2, 38824;DIVERSOS, MICROFONE BOYA BY-MC2, 38838;DIVERSOS, MICROFONE BOYA BY-MC2, 38837;DIVERSOS, MICROFONE BOYA BY-MC2, 38836;DIVERSOS, AMPLIFICADOR TSI TSI-625, 38782;DIVERSOS, AMPLIFICADOR TSI TSI-625, 38783;DIVERSOS, AMPLIFICADOR TSI TSI-625, 38784;DIVERSOS, AMPLIFICADOR NCA SA100ST, 50734;DIVERSOS, AMPLIFICADOR NCA SA100ST, 50733;DIVERSOS, CAIXA DE SOM JBL C621B, 38799;DIVERSOS, CAIXA DE SOM JBL C621B, 38798;DIVERSOS, CAIXA DE SOM JBL C621B, 38803;DIVERSOS, CAIXA DE SOM JBL C621B, 38802;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71527;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71557;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71584;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71562;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71539;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71594;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71552;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71580;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71564;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71549;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71567;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71516;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71596;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71535;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71588;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71578;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71538;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71505;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71548;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71565;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71513;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71501;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71556;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71515;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71577;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71507;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71570;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71536;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71550;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71547;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71600;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71576;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71586;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71544;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71525;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71504;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71571;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71533;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71511;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71569;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71545;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71541;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71572;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71508;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71593;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71574;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71561;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71581;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71524;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71585;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71534;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71587;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71595;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71554;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71568;DIVERSOS, CAIXA DE SOM FRAHM LC250, 71558;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP, 30735;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP, 41941;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP3000, 37624;DIVERSOS, RELOGIO DE PONTO TELEMATICA CodinReP3000, 37623;DIVERSOS, WEBCAM MICROSOFT N/A, 37285;DIVERSOS, RELOGIO DE PONTO DIMEP G05527939F, 72100;DIVERSOS, RELOGIO DE PONTO DIMEP G05527939F, 72098;DIVERSOS, WEBCAM LOGITECH C930E, 51225;DIVERSOS, NOBREAK SMS PRO 1500Bi, 73020;DIVERSOS, NOBREAK SMS PRO 1500Bi, 73019;DIVERSOS, NOBREAK SMS PRO 1500Bi, 73021'
		// const csv =
		// 	'NOTEBOOK, DELL P66F, 47428;NOTEBOOK, DELL P66F, 47675;NOTEBOOK, DELL BLACK , 36413;NOTEBOOK, DELL P66F, 47677;NOTEBOOK, DELL P66F, 47434;NOTEBOOK, DELL BLACK , 36417;NOTEBOOK, DELL E6410, 32046;NOTEBOOK, DELL XPS15Z, 34186;NOTEBOOK, DELL XPS15Z, 34185;NOTEBOOK, DELL P39F, 47130;NOTEBOOK, DELL P39F, 43266;NOTEBOOK, LENOVO 81B1, 2012;NOTEBOOK, DELL P66F, 47431;NOTEBOOK, DELL P37G003, 41895;NOTEBOOK, DELL LATITUDE 3400, 2086;NOTEBOOK, DELL P66F, 47672;NOTEBOOK, DELL P66F, 47437;NOTEBOOK, DELL 556 INSPIRON, 47829;NOTEBOOK, DELL LATITUDE 3490, 250;NOTEBOOK, DELL P66F, 47436;NOTEBOOK, DELL P66F, 47426'
		const csv =
			'NOTEBOOK, DELL P66F, 47682;NOTEBOOK, DELL P66F, 47679;NOTEBOOK, DELL LATITUDE 3400, 281;NOTEBOOK, DELL P66F, 47678;NOTEBOOK, DELL P66F, 47433;NOTEBOOK, DELL P66F, 47684;NOTEBOOK, LENOVO  IDEAPAD 310, 46591;NOTEBOOK, DELL P66F, 47444;NOTEBOOK, DELL P66F, 47443;NOTEBOOK, DELL P66F, 47666;NOTEBOOK, DELL P66F, 47677;NOTEBOOK, DELL LATITUDE 3490, 997;NOTEBOOK, DELL P39F, 47445'
		const arr = csv.split(';')

		function apenasNumeros(string) {
			var regex = /^[0-9]+$/
			return regex.test(string)
		}

		arr.map(async (item) => {
			console.log('zaaaa')
			const record = item.split(', ')
			if (apenasNumeros(record[2])) {
				console.log('x')
				const obj = {
					name: record[0],
					description: record[1],
					quantity: 1,
					product_code: parseInt(record[2]),
					request_code: 0,
					product_id: 30912099,
				}
				const response = await axios.post('http://10.1.1.19:3001/records/out', obj, {
					headers: {
						Authorization: `${token}`,
					},
				})
				console.log(obj)
			} else {
				const obj = {
					name: record[0],
					description: `${record[1]} -- ${record[2]}`,
					quantity: 1,
					product_code: 0,
					request_code: 0,
					product_id: 30912099,
				}
				const response = await axios.post('http://10.1.1.19:3001/records/out', obj, {
					headers: {
						Authorization: `${token}`,
					},
				})
				console.log(obj)
			}

			// if (apenasNumeros(record[2])) {
			// 	console.log('x')
			// 	const obj = {
			// 		name: record[0],
			// 		description: record[1],
			// 		product_code: parseInt(record[2]),
			// 		quantity: 1,
			// 		product_id: null,
			// 	}
			// 	const response = await axios.post('http://10.1.1.19:3001/records/in', obj, {
			// 		headers: {
			// 			Authorization: `${token}`,
			// 		},
			// 	})
			// 	console.log(obj)
			// } else {
			// 	const obj = {
			// 		name: record[0],
			// 		description: `${record[1]} -- ${record[2]}`,
			// 		product_code: 0,
			// 		quantity: 1,
			// 		product_id: null,
			// 	}
			// 	const response = await axios.post('http://10.1.1.19:3001/records/in', obj, {
			// 		headers: {
			// 			Authorization: `${token}`,
			// 		},
			// 	})
			// 	console.log(obj)
			// }
			// console.log(apenasNumeros(record[2]))
		})
	}, [])

	return (
		<>
			<div className="content">
				<div className="form_container">
					<form onSubmit={handleSubmit(onSubmit)}>
						<div className="input__container--check">
							<label>Produto possui patrimônio?</label>
							<label className="switch" htmlFor="checkbox">
								<input
									type="checkbox"
									id="checkbox"
									{...register('checkbox', { onChange: handleChange })}
									checked={checkboxValue}
								/>
								<div className="slider round"></div>
							</label>
						</div>
						<div className="input__container">
							<label htmlFor="">Patrimônio {checkboxValue && <b style={{ color: 'red' }}>*</b>}</label>
							<input
								type="text"
								id="product_code"
								disabled={!checkboxValue}
								{...register('product_code', { required: checkboxValue })}
							/>
						</div>
						<div className="input__container">
							<label htmlFor="">
								Modelo <b style={{ color: 'red' }}>*</b>
							</label>
							<input
								type="text"
								id="name"
								autoComplete="off"
								onInput={handleInput}
								{...register('name', { required: true })}
							/>
							{!checkboxValue && (
								<ul className="options">
									{options.map((item, index) => {
										let displayName = item.name
										nameCount[item.name] = true
										if (nameCount[item.name]) displayName = `${item.name} - ${item.description}`
										return (
											<li key={index} className="options__item" onClick={() => handleClick(item)}>
												{displayName}
											</li>
										)
									})}
								</ul>
							)}
						</div>
						<div className="input__container">
							<label htmlFor="">Quantidade {!checkboxValue && <b style={{ color: 'red' }}>*</b>}</label>
							<input
								type="number"
								id="quantity"
								disabled={checkboxValue}
								{...register('quantity', { required: !checkboxValue })}
							/>
						</div>
						<div className="input__container">
							<label htmlFor="">
								Descrição <b style={{ color: 'red' }}>*</b>
							</label>
							<textarea rows={4} id="description" {...register('description', { required: true })} />
						</div>
						<input type="hidden" id="product_id" {...register('product_id')} />
						<button type="submit">ENVIAR</button>
					</form>
				</div>
				<div className="logo">
					<Image width="250" height="250" src={Logo} alt="UVV logo" className="img" />
				</div>
			</div>
			{showPopup && <Popup message={showPopup.message} color={showPopup.color}></Popup>}
		</>
	)
}
